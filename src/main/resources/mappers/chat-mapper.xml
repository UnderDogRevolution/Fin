<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace = "chatmapper">
 <resultMap type="ChatRoom" id="chatRoom_rm"> <!-- 필드명과 db명이 일치하지않을때 mapping 하는 것 거의 사용  -->
		<id property="chatRoomNo" column="CHAT_ROOM_NO"/>
		<result property="statusCode" column="STATUS_CD"/>
		<result property="memberNo" column="MEMBER_NO"/>
		<result property="memberName" column="MEMBER_NM"/>
		<result property="freindNo" column="CHAT_FR_NO"/>
	
	
	</resultMap>
 	
 	<resultMap type="chatMessage" id="chatMessage_rm">
 		<id property="chatMessageNo" column="CM_NO"/>
 		<result property="createDate" column="CREATE_DT"/>
 		<result property="chatRoomNo" column="CHAT_ROOM_NO"/>
 		<result property="memberNo" column="MEMBER_NO"/>
 		<result property="memberName" column="MEMBER_NM"/>
 		<result property="memberId" column="MEMBER_ID"/>
 	</resultMap>
 	
 	
 	 	<!-- 채팅방 목록 조회 (상관커리) -->
 	<select id="chatRoomList" resultMap="chatRoom_rm">

	SELECT CHAT_ROOM_NO,TITLE,MEMBER_NM,MEMBER_NO,
	(SELECT MEMBER_NO FROM CHAT_ROOM_JOIN J WHERE J.CHAT_ROOM_NO = R.CHAT_ROOM_NO AND MEMBER_NO != 21)CHAT_FR_NO
	FROM CHAT_ROOM R
	JOIN MEMBER USING(MEMBER_NO)
	WHERE R.STATUS_CD = 1
	AND MEMBER_NO = 21
	ORDER BY 1 DESC;    
 	</select>
 	
 	
 	
</mapper>
